# Реализация памяти
* [Введение](#введение)
* [Память на линиях задержки](#память-на-линиях-задержки)
* [Память на магнитных сердечниках](#память-на-магнитных-сердечниках)
* [Запоминающая электронно-лучевая трубка](#запоминающая-электронно-лучевая-трубка)
* [Магнитный барабан](#магнитный-барабан)

## Введение
Меня немножко подзадолбало писать материалы лекций, особенно учитывая, что в прошлый раз я справился, практически не обращаясь к своим конспектам, так что теперь здесь будет исключительно копипаста из источников, которые я себе выбрал и к которым я буду обращаться за цифрами и датами, потому что я не хочу заставлять себя их запоминать.

## Память на линиях задержки
**Память на линиях задержки** — разновидность компьютерной памяти, использовавшейся в ранних цифровых компьютерах, например EDSAC, ACE и БЭСМ, в радиолокационной технике и декодерах сигналов цветности аналоговых цветных телевизоров систем PAL и SECAM.

Основная идея линий задержки возникла в ходе разработки радаров во время Второй мировой войны, а именно для сокращения помех от отражения от земли и неподвижных объектов. Радары того времени использовали периодические импульсы радиоволн, отражённые радиоволны принимались и усиливались для отображения на экране. Чтобы убрать неподвижные объекты с экрана радара, отражённый сигнал разделяли на два, один из которых использовался непосредственно, а второй задерживался. В электрической схеме из нового сигнала вычитался задержанный сигнал предыдущего цикла. (Нормальный сигнал складывался с задержанным инверсным.) В результирующем сигнале оставались только изменения между двумя сигналами и он выводился на экран. Таким образом на экране отображались только подвижные объекты.

### Ртутные акустические линии
До использования линий задержки в качестве цифровых запоминающих устройств первые подобные системы с линиями задержки состояли из наполненных ртутью трубок с пьезокристаллическим преобразователем на концах (аналоги динамика и микрофона, на передающих и приёмных концах соответственно). Сигналы от радарного усилителя посылались на пьезокристалл в одном конце трубки, и тот, получая импульс, генерировал небольшое колебание ртути. Колебание быстро передавалось на другой конец трубки, где другой пьезокристалл его инвертировал и передавал на экран. Было необходимо точное механическое согласование для обеспечения подбираемого времени задержки между импульсами, которое специфично для каждого использовавшегося радара.

Ртуть использовалась потому, что её удельное акустическое сопротивление почти равно акустическому сопротивлению пьезокристаллов. Это минимизировало энергетические потери, происходящие при передаче сигнала от кристалла ко ртути и обратно. Высокая скорость звука во ртути (1450 м/с) позволяла уменьшить время ожидания импульса, прибывающего на принимающий конец, по сравнению со временем ожидания в другой, более медленной среде передачи (например, воздухе), но это также означало и то, что конечное число импульсов, которые можно сохранить в приемлемом количестве ртутных трубок, было ограничено. Другими отрицательными сторонами применения ртути были её вес, цена и токсичность. Более того, для того чтобы добиться согласования акустических сопротивлений настолько, насколько это возможно, ртуть надо содержать при температуре +40 °C, что делает обслуживание ртутных трубок жаркой и некомфортной работой.

Для применения в компьютерах временные интервалы также были критичными, но по другой причине. Все традиционные компьютеры имели естественную длительность цикла памяти, необходимую для выполнения операций, начало и окончание которых обычно заключается в чтении памяти и записи в неё же. Таким образом, линии задержки надо было синхронизировать так, чтобы импульсы поступали на приёмник именно в тот момент, когда компьютер был готов считать их. Обычно в линиях задержки перемещалось множество импульсов одновременно, и компьютеру для нахождения искомого одиночного бита приходилось отсчитывать импульсы, сравнивая их с синхроимпульсами.

Изобретённая Джоном Преспером Экертом для компьютера EDVAC и использовавшаяся в UNIVAC I ртутная линия задержки добавила повторитель на принимающем конце ртутной линии задержки для посылки выходного сигнала обратно на вход. В этом случае импульс, посланный в систему, продолжал циркулировать до тех пор, пока было электропитание.

Чтобы поддерживать в линии задержки сигнал без помех, требовалось значительное количество инженерных усилий. Для генерирования очень узкой акустической волны, которая не касалась бы стенок трубки, использовались многочисленные преобразователи. Также необходимо было заботиться об устранении отражения сигнала от противоположного конца трубки. Так как волна была узкой, была необходима значительная настройка прибора с тем, чтобы пьезокристаллы находились точно друг напротив друга. В связи с тем, что скорость звука менялась при изменении температуры (из-за зависимости плотности от температуры), трубки находились в термостатах, чтобы их температура была постоянной. Вместо этого, для достижения такого же эффекта, другие системы для соответствия окружающей температуре регулировали тактовую частоту компьютера.

EDSAC, первая действительно работающая цифровая вычислительная машина с хранимой в памяти программой, производила операции с 512 35-битным словами памяти, хранившимися в 32 линиях задержки, каждая из которых удерживала 576 бит (36-й бит добавлялся к каждому слову в качестве стартового/стопового). В UNIVAC 1 схема отчасти была упрощена, каждая трубка хранила 120 бит и требовалось 7 больших блоков памяти с 18 трубками каждый для создания хранилища памяти на 1000 слов. Объединённые вместе с усилителями и вспомогательными схемами, они составляли подсистему памяти и занимали целую отдельную комнату. Среднее время доступа к памяти составляло около 222 мкс, что было значительно быстрее, чем в механических системах, использовавшихся в более ранних компьютерах.

### Проволочная линия задержки
Более поздний вариант линий задержки использовал в качестве хранителя информации металлическую проволоку c магнитострикционными преобразователями. Маленькие кусочки магнитострикционного материала, обычно никеля, прикреплялись с каждой стороны одного из концов проволоки, находящейся внутри электромагнита. Когда биты из компьютера передавались на магнит, никель сжимался или расширялся и закручивал конец проволоки. Получившаяся волна кручения двигалась по проволоке так же, как звуковая волна двигалась по трубке со ртутью.

Однако, в отличие от сжимающей волны, волна кручения была значительно более стойкой к проблемам, связанным с механическими дефектами, настолько, что проволока сматывалась в катушку и прикреплялась к доске. Благодаря способности скручиваться системы на основе проволоки могли иметь такую длину, какая была необходима, и способствовали сохранению значительно большего количества данных на одном элементе. 1000 запоминающих элементов обычно умещались на доске площадью в 1 квадратный фут (0,093 м²). Правда, это также означает, что время, необходимое для поиска каждого отдельного бита, было немного больше из-за перемещения по проволоке, и время доступа в среднем составляло порядка 500 мкс.

Память на линиях задержки была гораздо менее дорогостоящей и гораздо более надёжной, чем триггеры из вакуумных ламп, и более быстрой, чем реле с самоудержанием (реле-защёлки). Она использовалась до конца 1960-х годов, особенно в британских коммерческих компьютерах LEO I, различных компьютерах компании Ferranti и в настольном программируемом калькуляторе Olivetti Programma 101, выпущенном в 1965 году. Компактные безртутные проволочные магнитострикционные линии задержки устанавливали в электронные клавишные вычислительные машины (ЭКВМ) серии «Искра», а также «Электроника-155».

Дольше всего (до начала 2000-х годов) память на линиях задержки просуществовала в аналоговых цветных телевизорах, где использовалась для запоминания цветоразностных сигналов на период времени, равной длине одной строки телевизионного растра. В системе PAL это необходимо для компенсации фазовых искажений тракта передачи сигналов, а в системе SECAM — для обеспечения существования в каждой строке одновременно двух цветоразностных сигналов, передаваемых последовательно через строку.

## Память на магнитных сердечниках
ферритовая память — запоминающее устройство, хранящее информацию в виде направления намагниченности небольших ферритовых сердечников, обычно имеющих форму кольца. Ферритовые кольца расставлялись в прямоугольную матрицу и через каждое кольцо проходило (в зависимости от конструкции запоминающего устройства) от двух до четырёх проводов для считывания и записи информации. Память на магнитных сердечниках была основным типом компьютерной памяти с середины 1950-х и до середины 1970-х годов.

Схема с кольцеобразными сердечниками и четырьмя проводниками работает по принципу совпадения токов. Направление намагниченности одного ферритового кольца позволяет хранить один бит информации. Через кольцо проходят четыре провода: два провода возбуждения X и Y, провод запрета Z под углом 45°, провод считывания S под углом 90°. Для считывания значения бита на провода возбуждения подаётся импульс тока таким образом, что сумма токов через отверстие сердечника приводит к тому, что намагниченность кольца принимает определённое направление независимо от того, какое направление она имело до этого. Значение бита можно определить, измерив ток на проводе считывания: если намагниченность сердечника изменилась, то в проводе считывания возникает индукционный ток.

Процесс считывания (как и в запоминающей ЭЛТ) разрушает сохранённую информацию, следовательно, бит после считывания необходимо записать повторно.

Для записи на провода возбуждения подаётся импульс тока в обратном направлении и намагниченность сердечника меняет направление (относительно того, которое она имеет после считывания). Однако если при этом в другом направлении подаётся ток на провод запрета, то суммы токов через кольцо недостаточно, чтобы изменить намагниченность сердечника, и она остаётся такой же, как после считывания.

Матрица памяти состоит из N² кольцеобразных сердечников, нанизанных на пересечения перпендикулярных проводов возбуждения X1…XN и Y1…YN. Через все сердечники проплетается один провод считывания и один провод запрета. Таким образом, матрица позволяет считывать или записывать биты только последовательно.

Силу тока в проводах возбуждения и материал сердечника подбирают так, чтобы тока через один провод не хватило бы для изменения намагниченности сердечника. Это необходимо, поскольку на один провод возбуждения нанизано несколько десятков сердечников, а менять направление намагниченности нужно только в одном из них. Следует отметить, что минимальная сила тока, которая может изменить намагниченность сердечника, зависит от температуры сердечника. Производители компьютерной техники решали эту проблему по-разному. Компьютеры серии PDP фирмы DEC регулировали силу тока возбуждения при помощи термистора. В компьютерах IBM матрицы памяти помещались в воздушную «духовку» или в масляную ванну, в которой поддерживалась постоянная высокая температура.

### История разработки
Идея запоминающего устройства в виде матрицы ферритовых сердечников впервые возникла в 1945 году у Джона Преспера Экерта, одного из создателей ЭНИАКа. Его отчёт широко циркулировал среди американских компьютерных специалистов. В 1949 году Ван Ань и Во Вайдун — молодые сотрудники Гарвардского университета китайского происхождения — изобрели сдвиговый регистр на магнитных сердечниках (Ван назвал его «устройством, управляющим передачей импульсов» — pulse transfer controlling device) и принцип «запись — считывание — восстановление», который позволил использовать сердечники, у которых процесс считывания разрушает информацию. В октябре 1949 года Ван подал заявку на патент, и получил его в 1955 году. К середине 1950-х память на магнитных сердечниках уже получила широкое распространение. Ван подал в суд на IBM, и IBM пришлось выкупить патент у Вана за 500 000 $.

Тем временем Джей Форрестер в Массачусетском технологическом институте работал над компьютерной системой Whirlwind («Вихрь»). Изначальные планы использовать память на матрице запоминающих ЭЛТ к успеху не привели. В 1949 году, также как и у Вана, у Форрестера возникла идея о памяти на магнитных сердечниках. Согласно утверждениям самого Форрестера, он пришел к этому решению независимо от Вана. В марте 1950 года Форрестер со своей командой разработал ферритовую память, работающую по принципу совпадения токов; предложенная им схема с четырьмя проводами — X, Y, считывание, запрет — стала общепринятой (см. описание выше). В мае 1951 года Форрестер подал заявку на патент, и получил его в 1956 году.

## Запоминающая электронно-лучевая трубка
**Запоминающая электронно-лучевая трубка** (она же трубка Уильямса) — запоминающее устройство на основе электронно-лучевой трубки. Запоминающие трубки использовались в качестве памяти на некоторых ранних компьютерах.

При попадании электронного луча на точку p на люминофорном экране ЭЛТ происходит вторичная эмиссия, и участок люминофора в точке p обретает положительный заряд. Если луч отключается сразу, то благодаря электрическому сопротивлению люминофорного слоя точка положительного заряда некоторое время (долю секунды) держится на экране. Однако если луч не отключается, а отклоняется в сторону от p, рисуя «тире» на экране трубки, то электроны, испущенные в процессе вторичной эмиссии под лучом, поглощаются люминофором в точке p, и точка p обретает нейтральный заряд. Таким образом, выделив на экране некое количество точек p1…pN, можно записать N битов информации (точка без заряда означает 1, точка с положительным зарядом — 0).

Для считывания информации к внешней стороне экрана прикрепляется пластина с электродами. На точку p снова направляется электронный луч. Происходит вторичная эмиссия электронов, и точка обретает положительный заряд независимо от того, какой заряд она имела до этого. Электрод на внешней стороне экрана позволяет измерить величину изменения заряда точки, то есть определить её изначальный заряд, и, следовательно, значение данного бита. Процесс считывания уничтожает информацию, которая хранится в точке, следовательно, после считывания каждого бита необходимо повторно записать значение бита на люминофор.

Люминофор быстро теряет заряд, поэтому необходимо регулярно считывать и перезаписывать записанную информацию (аналогично процессу регенерации в современной памяти DRAM).

### Потенциалоскоп
**Потенциалоскоп** — электронно-лучевой прибор, предназначенный для накопления определённой информации и её последующего воспроизведения. В 1970-е годы потенциалоскопами стали называть также запоминающие электронно-лучевые трубки.

При записи потенциалоскоп работал на основе накопления электрических зарядов на поверхности «мишени» в соответствии с записываемой информацией. Информация могла поступать в виде электрических импульсов или, в случае фоточувствительной мишени, проецирования оптического изображения. При чтении распределение накопленного заряда преобразовывалось в выходной сигнал.

Время хранения информации изменялось в широких пределах — от долей секунды до нескольких часов и даже дней. Для длительного хранения информации использовалась высокая изоляция мишени, или специальный электронный луч, поддерживающий потенциал на мишени.

Чтение было частично разрушающим, разные конструкции потенциалоскопов допускали от одного до десятков и сотен тысяч считываний после одной записи.

В бистабильных потенциалоскопах потенциал мишени является положительным по отношению к потенциалу катода отображающего прожектора, и отображающий пучок приводит её потенциал к двум стабильным значениям, из-за чего изображение не теряется длительное время.

## Магнитный барабан
Магниитный барабан — устройство компьютерной памяти, широко использовавшееся в 1950-х — начале 1960-х годов.

Конструктивно барабан представляет собой большой быстро вращающийся металлический цилиндр, наружная поверхность которого покрыта тонким ферромагнитным слоем. Несколько считывающих головок расположены по одной или нескольким образующим цилиндра, каждая из головок считывает и записывает данные на своей отдельной магнитной дорожке.

### Внешняя и оперативная память
Для многих вычислительных машин первого поколения барабан, помимо применения в качестве внешней памяти, выполнял функции оперативной памяти: на нём хранились выполняемые программы и обрабатываемые данные (в качестве внешней памяти тогда использовались такие носители информации, как перфоленты, перфокарты, накопители на магнитных лентах.)

В дальнейшем в применениях в качестве оперативной памяти магнитный барабан был вытеснен памятью на магнитных сердечниках. Она работала быстрее, не имела движущихся частей, время доступа в ней не зависело от расположения информации (память с произвольным доступом, англ. RAM), поэтому она использовалась вплоть до появления полупроводниковой памяти.

В качестве внешней памяти на смену барабанам пришли жёсткие диски, будучи менее дорогими и более ёмкими.

### Характеристики и особенности использования
Ключевое различие между барабаном и жёстким диском заключается в том, что на барабане головки неподвижны, доступ к нужным фрагментам (секторам) информации обеспечивается вращением барабана. Это означает, что время доступа к любому одиночному фрагменту информации меньше, чем оно было бы на жестком диске с подвижными головками и в среднем составляет половину длительности одного оборота барабана. Контроллер ожидает, когда данные подойдут к выбранной головке при повороте барабана. Время доступа у магнитных барабанов полностью определяется скоростью их вращения, в то время как у жесткого диска определяется как скоростью вращения, так и скоростью перемещения головок по цилиндрам диска.

Тем не менее, во многих применениях время доступа было неприемлемо велико. Поэтому программисты часто, при написании программ, оптимизировали расположение информации на барабане так, чтобы после обработки порции информации процессором, следующая порция данных или блок программы в это время как раз подходил к головке барабана. Это достигалось тщательным измерением времени исполнения частей программы и готовности процессора к выполнению следующего блока инструкций, располагая следующий кусок программного кода на барабане так, чтобы он в момент окончания исполнения предыдущего блока программы «подъезжал» точно под считывающую головку. Такой метод оптимизации временны́х задержек, обусловленный последовательным доступом к информации на барабане, называется «фактором (коэффициентом) пропуска» (англ. Skip Factor) или «чередованием секторов» (англ.) и используется так же в контроллерах жёстких дисков.

### Интересный факт
В некоторых операционных системах семейства BSD устройством /dev/drum (то есть «барабаном») по умолчанию называется устройство для подкачки страниц виртуальной памяти, хотя уже давно барабаны для хранения информации не используются.
